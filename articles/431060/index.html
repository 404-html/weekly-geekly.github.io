<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>German ID Spoofing with Online Authentication and Refugee Financing in Germany</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="German ID 

 Security specialist Wolfgang Ettlinger of the SEC Consult Vulnerability Lab described data falsification techniques (including name and a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="https://quick-geek.github.io/search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <section class="page js-page"><h1>German ID Spoofing with Online Authentication and Refugee Financing in Germany</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/ow/vu/gy/owvugymws9zt20klvqzd3n4peow.jpeg"><br>  <i><font color="gray">German ID</font></i> <br><br>  Security specialist Wolfgang Ettlinger of the SEC Consult Vulnerability Lab <a href="https://sec-consult.com/en/blog/2018/11/my-name-is-johann-wolfgang-von-goethe-i-can-prove-it/">described</a> data falsification techniques (including name and address) during an online verification of German state IDs. <br><br>  German ID cards are issued from November 1, 2010.  Each card contains an RFID chip that stores information about the owner, including the name, date of birth, and biometric photo.  If the owner wants, he can record a scan of fingerprints. <br><a name="habracut"></a><br>  New maps are machine-readable and can be used as travel documents in most European countries, as well as for authentication in online public services (tax, postal) or for checking age.  They are used to authenticate users in some online services, including <a href="https://www.elster.de/eportal/start">the tax return filing portal</a> . <br><br>  RFID authentication is performed using a card reader and eID client application (for example, <a href="https://www.ausweisapp.bund.de/ausweisapp2-home/">AusweisApp 2</a> ), which interacts with the RFID chip and authentication server (eID-Server or SAML-Processor) to verify login data. <br><br><img src="https://habrastorage.org/webt/ig/vo/hi/igvohib14pk4x2t3z2eiuzihwo8.png"><br><br>  To prevent falsification of identity data, the authentication server verifies the accuracy of the information and then signs the response that is sent to the web service from the client so that the web service can trust the legitimacy of the data received. <br><br>  Wolfgang Ettlinger found a way to trick the web application by sending him changed data.  The screenshot shows how he successfully authenticated in the official application under the name of Johann Wolfgang von Goethe, a famous German writer.  The form contains the address where the writer lived for 50 years, where the Goethe Museum is located today. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9v/6o/le/9v6olej-iet50vlt3duvjz8jzim.png"></div><br><br>  The vulnerability appeared in the Governikus Autent SDK, a software component for integrating the authentication feature into web applications.  Including it implements the authentication verification function from the eID client.  The point is that the <a href="https://www.bsi.bund.de/DE/Publikationen/TechnischeRichtlinien/tr03130/tr-03130.html">check is performed in two independent steps</a> .  At the first stage, the validity of the authentication server signature is checked, and at the second stage, the data itself, including the identity of the owner.  As a result, it is possible to send two independent SAML responses to the application: the first with a valid signature, and the second with fake data and without a signature. <br><br>  The exploit is based on the fact that the Governikus Autent SDK verifies the signature using the <code>HttpRedirectUtils.checkQueryString</code> method, which does not consider using the same parameter several times.  Thus, after checking a parameter, other instances are analyzed as if they had already passed the test. <br><br>  Here is how this method is used in a real application: <br><br><pre> <code class="xml hljs">// check the signature of the SAML response. There is no XML signature in this response but the // parameter are signed. if (!HttpRedirectUtils.checkQueryString(request.getQueryString(), SamlExampleHelper.SERVER_SIG_CERT)) { storeError(request, response, "Signaturpr√ºfung der SAML-Response fehlgeschlagen!"); return; }</code> </pre> <br>  The method receives the query string, analyzes it, creates a canonical version of the query string and verifies the signature. <br><br>  Then the SAML response is parsed: <br><br><pre> <code class="xml hljs">// get the parameter value String samlResponseBasee64 = request.getParameter(HttpRedirectUtils.RESPONSE_PARAMNAME); [...] // parse the SAML Response. ParsedResponse parsed = parser.parse(samlResponse);</code> </pre> <br>  As already mentioned, <code>HttpRedirectUtils.checkQueryString</code> does not consider using a parameter several times, always using the last value of the parameter. <br><br>  To successfully exploit this vulnerability, an attacker needs a query string signed by an authentication server.  Details such as the time of signing or the person for whom it was requested do not matter.  Even if the query string is valid for a short period, validation is performed on the data on the identification card.  According to the researcher, getting a valid query is not difficult if you know where to look, since they are available using Google search through eID client logs. <br><br>  Researchers show their results in the video: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/kaATyYmpiIE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Vulnerable web applications running under Governikus Autent SDK 3.8.1 and earlier versions that handle repeated HTTP parameters.  Vulnerability can be used, for example, to register in online services under an assumed name. <br><br>  Why might need such a fake name?  We can give such an abstract example.  Recently, the German Interior Ministry launched the initiative <a href="https://www.returningfromgermany.de/ru">"Voluntary Return"</a> , in which it finances any foreigner who wishes to go home voluntarily.  Payment of a ticket and accommodation costs less to the government than forced deportation of a refugee ( <a href="https://www.tagesschau.de/inland/freiwillige-rueckkehr-101.html">700 versus 1500 euros</a> ), that is, funding makes sense. <br><br><img src="https://habrastorage.org/webt/lc/cb/jk/lccbjkusxgwlhpmt3whhmaf3qjc.jpeg"><br>  <i><font color="gray">An advertising campaign in the Berlin subway: for refugees who, until December 31, notify the German authorities of their voluntary departure to their homeland, are compensated for the annual rent of housing in their home country</font></i> <br><br>  Theoretically, any foreigner can come to Germany, apply for refugee status, be refused - and immediately funded under this program.  The only problem for a fraudster is that you can do this trick only once.  Obviously, the services will then check that no benefit has been issued in his name yet.  But if you register in the program under a different name, you can receive money many times (theoretically). <br><br>  Of course, the spoofing of the state German eID will not help the fraudster with a foreign passport to come to Germany under a new name.  But this example shows that in every protection system there are necessarily vulnerabilities.  The only question is the desire and resources to find them. <br><br> <a href="https://clck.ru/EWJHw"><img src="https://habrastorage.org/webt/ee/nb/3h/eenb3h7tlf1y8rk6f7cjtpp-x9u.jpeg"></a> </div><p>Source: <a href="https://habr.com/ru/post/431060/">https://habr.com/ru/post/431060/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><p>Waiting for the list form <a href="../../index.html">here</a>...</p></nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>