<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mamba: open-source crypto-fiber</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At the end of 2016, public transport passengers of San Francisco noticed a laconic message on the information monitors instead of the timetable: ‚ÄúAll ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mamba: open-source crypto-fiber</h1><div class="post__text post__text-html js-mediator-article">  At the end of 2016, public transport passengers of San Francisco noticed a laconic message on the information monitors instead of the timetable: ‚ÄúAll data is encrypted‚Äù.  So for the first time the crypto-fiber Mamba declared itself publicly.  After that, the cryptographer seems to have gone to the bottom, but the other day he appeared again.  This time, organizations in Brazil and Saudi Arabia were attacked. <br><div style="text-align:center;"><img src="https://habrastorage.org/web/de7/9ea/3d3/de79ea3d3408403e949a5b9ca2ce40b6.png"></div><br>  Mamba is notable for the fact that its authors did not bother with the home-grown implementation of encryption, but simply used the open source utility DiskCryptor.  Operators of Mamba penetrate into the network of the organization and launch the crypto-fiber utility psexec.  For each machine on the network, a separate encryption password is generated, which is transmitted via the command line parameters to the Tropper‚Äôs dropper. <br><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/web/7e3/d43/9b1/7e3d439b113b4b319dd2c607e9723a7e.png"></div><br><br>  The data attack process can be divided into two stages: <br><br>  Stage 1 - preparation: <br><br>  1. The directory ‚ÄúC: \ xampp \ http‚Äú is created. <br>  2. DiskCryptor is written to the directory. <br>  3. The system installs the DiskCryptor driver. <br>  4. The system registers the service DefragmentService. <br>  5. The system reboots. <br><br>  Pay attention to the step of writing components DiskCryptor.  Dropper Mamba installs a 32- or 64-bit version depending on the system capacity. <br><br><img src="https://habrastorage.org/web/c35/454/c4a/c35454c4a3ed4c8c95bbc7bf68313431.png"><br><br>  The driver is installed is not very surprising - with the installer DiskCryptor. <br><br><img src="https://habrastorage.org/web/286/bc4/dd7/286bc4dd74954c018c735ce394f5938f.png"><br><br>  After that, the Trojan creates a service with the parameters SERVICE_ALL_ACCESS and SERVICE_AUTO_START. <br><br><img src="https://habrastorage.org/web/1be/78f/978/1be78f9785fa429e945dcf18b4b1c46a.png"><br><br>  And at the end Mamba performs a forced reboot. <br><br><img src="https://habrastorage.org/web/b65/e29/1cf/b65e291cfe7e40fd98d1905c80fea0c0.png"><br><br>  Stage 2 - Encryption: <br><br>  1. A boot loader is written to the MBR of a disk, and DiskCryptor encrypts the logical disks. <br>  2. Cleaning the system. <br>  3. The system reboots. <br><br>  The bootloader in the MBR is installed using DiskCryptor. <br><br><img src="https://habrastorage.org/web/568/e00/387/568e00387fd94d0581fc3a4f68b885f1.png"><br><br>  The bootloader has a requirement to contact extortionists. <br><br><img src="https://habrastorage.org/web/a1b/567/3ac/a1b5673ace27468c864576d64795bff7.png"><br><br>  Finally, the Trojan calls DiskCryptor to encrypt a disk with a password, transmitted via a command line parameter. <br><br><img src="https://habrastorage.org/web/08b/ab6/aab/08bab6aabe254241ad901a443e4a9df0.png"><br><br>  After the reboot, the victim sees the message of the ransomware. <br><br><img src="https://habrastorage.org/web/1bb/ad5/eba/1bbad5eba0434b70a0d6a3b63a9e3c71.png"><br><br>  Decryption without a password is not possible - DiskCryptor uses strong encryption algorithms.  Our products will detect Mamba as PDM: Trojan.Win32.Generic, infection indicator 79ED93DF3BEC7CD95CE60E6EE35F46A1. </div><p>Source: <a href="https://habr.com/ru/post/335704/">https://habr.com/ru/post/335704/</a></p>
<section class="all-articles-navigation-panel js-all-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><p>Waiting for the list form <a href="../../index.html">here</a>...</p></nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>