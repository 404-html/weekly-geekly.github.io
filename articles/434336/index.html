<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using the KOMPAS-3D API ‚Üí Lesson 13 ‚Üí Paragraphs</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Before proceeding to the discussion of documented ways to create compound lines, we need to get acquainted with an object such as a paragraph. It is a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using the KOMPAS-3D API ‚Üí Lesson 13 ‚Üí Paragraphs</h1><div class="post__text post__text-html js-mediator-article">  Before proceeding to the discussion of documented ways to create compound lines, we need to get acquainted with an object such as a paragraph.  It is an automatically formatted block of text consisting of several lines.  In this lesson we will look at the construction of simple paragraphs. <br><br><img src="https://habrastorage.org/webt/m7/wu/vw/m7wuvw0aeqqqfed0yocjongme0g.png"><br><a name="habracut"></a><br><blockquote><h4>  Content of the cycle of lessons ‚ÄúWorking with the API KOMPAS-3D‚Äù </h4><br><ol><li>  <a href="https://habrahabr.ru/company/ascon/blog/328088/">The basics</a> </li><li>  <a href="https://habrahabr.ru/company/ascon/blog/330588/">Drawing design</a> </li><li>  <a href="https://habrahabr.ru/company/ascon/blog/332554/">Correct connection to COMPAS</a> </li><li>  <a href="https://habrahabr.ru/company/ascon/blog/337288/">Title block</a> </li><li>  <a href="https://habrahabr.ru/company/ascon/blog/342030/">Graphic primitives</a> </li><li>  <a href="https://habrahabr.ru/company/ascon/blog/346772/">Save the document in various formats</a> </li><li>  <a href="https://habrahabr.ru/company/ascon/blog/350512/">Introduction to the settings</a> </li><li>  <a href="https://habr.com/company/ascon/blog/350516/">More sophisticated writing methods</a> </li><li>  <a href="https://habr.com/company/ascon/blog/359232/">Reading the caption cells</a> </li><li>  <a href="https://habr.com/company/ascon/blog/414701/">Special characters including string</a> </li><li>  <a href="https://habr.com/company/ascon/blog/417723/">Simple text lettering</a> </li><li>  <a href="https://habr.com/company/ascon/blog/424509/">Compound strings</a> </li><li>  <b>Paragraphs</b> </li><li>  Multiline text </li></ol></blockquote><h2>  <font color="#00B2FF">Paragraph Parameters ( <b>ksParagraphParam</b> )</font> </h2><br>  The paragraph is described by the <b>ksParagraphParam</b> interface.  To get it, you need to use the <b>KompasObject</b> interface's <b>GetParamStruct method</b> , for this it needs to pass the constant <b>ko_ParagraphParam</b> ( <i>0x0000001B</i> ).  Consider the properties of the interface <b>ksParagraphParam</b> . <br><br>  <b>ang</b> - the angle of the text in degrees.  Delayed from the horizontal line counterclockwise.  Similar to the <b>ang</b> parameter of the <b>ksText</b> method. <br><br>  <b>height</b> - the height of the paragraph in millimeters. <br><br>  <b>hFormat</b> - formatting text horizontally.  This property is used when the text does not fit in a paragraph in width.  Valid values ‚Äã‚Äãare listed in the table below. <br><br><img src="https://habrastorage.org/webt/-s/mj/m9/-smjm9ygdwb7dufeynhaolmpvuo.png"><br><br>  <b>style</b> - text style (described in <a href="https://habr.com/company/ascon/blog/417723/">lesson 11</a> ). <br><br>  <b>vFormat</b> - formatting text vertically.  This property is used when the text does not fit in a paragraph in height.  Valid values ‚Äã‚Äãare listed in the table below. <br><br><img src="https://habrastorage.org/webt/jc/hj/9r/jchj9re-6fbg2cp6vc_x6dvsl2o.png"><br><br>  When working with the <b>vFormat</b> property, <b>you</b> need to remember two things: <br><br><ol><li>  According to the KOMPAS documentation, the valid values ‚Äã‚Äãfor the <b>vFormat</b> property are <i>0</i> and <i>-1</i> , but this is not the case.  Valid values ‚Äã‚Äãare <i>0</i> and <i>1</i> . </li><li>  COMPASS does not change the height of characters.  It only changes the distance between the lines.  If the height of the lines is less than the height of the paragraph, then they may overlap.  An example of this overlay is in the figure below. </li></ol><br> <a href=""><img src="https://habrastorage.org/webt/bk/hp/se/bkhpsesuq36ncmmwbotgfwuxdla.png"></a> <br><br>  <b>width</b> - the width of the paragraph in millimeters. <br>  The <b>height</b> , <b>hFormat</b> , <b>vFormat,</b> and <b>width</b> properties allow us to solve the problem of placing text in a given rectangle.  This method is much safer and more efficient, unlike the <b>ksGetTextLength</b> method discussed in <a href="https://habr.com/company/ascon/blog/417723/">Lesson 11</a> . <br><br>  <i>The x</i> and <i>y</i> coordinates of the anchor point.  The position of the paragraph relative to the anchor point along the horizontal axis is adjusted by the <b>ksSetTextAlign</b> method of the <b>ksDocument2D</b> interface (although this possibility has not been documented).  Vertically, the anchor point always coincides with the bottom of the first line of the paragraph.  This behavior cannot be changed. <br>  <b>There is</b> only one method for the <b>ksParagraphParam</b> interface: <b>Init ()</b> .  It initializes the values ‚Äã‚Äãof the interface properties.  It has no input parameters.  Returns <i>true</i> if successful. <br><br><h2>  <font color="#00B2FF">Building a paragraph</font> </h2><br>  Creating a paragraph consists of three consecutive stages. <br><br><ol><li>  Announcement of the beginning of a paragraph.  To do this, call the <b>ksParagraph</b> method of the <b>ksDocument2D</b> interface.  As a single parameter, this method accepts the <b>ksParagraphParam</b> interface, which sets the parameters of the paragraph.  If successful, the <b>ksParagraph</b> method returns a one, and in case of error, it returns <i>zero</i> . </li><li>  Filling a paragraph.  For each line displayed in the paragraph, the <b>ksTextLine</b> method of the <b>ksDocument2D</b> interface is <b>called</b> .  As a single parameter, it accepts the <b>ksTextItemParam</b> interface or the <b>ksTextLineParam interface</b> (discussed in previous loop lessons), which describe the line.  Note that the output lines must not contain the characters <i>@</i> , <i>$</i> , <i>&amp;</i> , <i>~</i> , <i>^</i> and <i>#</i> , as they are control characters.  Working with them will be discussed in the following lessons of the cycle. </li><li>  Completion of the paragraph.  For this, the <b>ksEndObj ()</b> method of the <b>ksDocument2D</b> interface is <b>called</b> .  It has no input parameters and, if successful, returns an integer pointer to the created object (paragraph).  In the event of an error, it returns <i>zero</i> . </li></ol><br><h2>  <font color="#00B2FF">Example.</font>  <font color="#00B2FF">Simplest paragraph</font> </h2><br><div class="spoiler">  <b class="spoiler_title">Below is the source code of the program, demonstrating the construction of the simplest paragraph.</b> <div class="spoiler_text"><pre><code class="plaintext hljs">//–ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ksTextItemParam TextItemParamPtr textItemParam; textItemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); //–ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ ParagraphParamPtr paragraphParam; paragraphParam = static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(100.0); paragraphParam-&gt;set_y(100.0); //–ù–∞—á–∏–Ω–∞–µ–º –ø–∞—Ä–∞–≥—Ä–∞—Ñ Document2D-&gt;ksParagraph(paragraphParam); //–ù–∞–ø–æ–ª–Ω—è–µ–º –ø–∞—Ä–∞–≥—Ä–∞—Ñ BSTR str = SysAllocString(L"–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞"); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); str = SysAllocString(L"–í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞"); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); //–ó–∞–≤–µ—Ä—à–∞–µ–º –ø–∞—Ä–∞–≥—Ä–∞—Ñ Document2D-&gt;ksEndObj(); paragraphParam.Unbind(); textItemParam.Unbind();</code> </pre> <br></div></div><br>  As always, for simplicity, the code responsible for the creation and execution of the document is omitted (this topic was covered in previous lessons). <br><br>  In this example, KOMPAS itself determines the size of the paragraph based on its content.  The figure below shows the generated paragraph. <br><br><img src="https://habrastorage.org/webt/jz/hi/b-/jzhib-bs44smvqvokcomp3shwmg.png"><br><br>  Note: the text is displayed as one line.  We did not specify the width of the paragraph, so KOMPAS automatically increases it as necessary.  If the width were set, the behavior of KOMPAS would be determined by the value of the <b>hFormat</b> property of the <b>ksParagraphParam</b> interface. <br><br>  For the formation of multi-line and composite text, you must use the features of the outline, partially discussed in the previous lesson. <br><br><h2>  <font color="#00B2FF">Example.</font>  <font color="#00B2FF">Multiline text</font> </h2><br>  For an explicit transfer to a new line, the <b>NEW_LINE</b> ( <i>0x1000</i> ) flag is used. <br><br><div class="spoiler">  <b class="spoiler_title">Below is an example of a program that demonstrates the construction of a multi-line paragraph using this flag.</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">//–ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ksTextItemParam TextItemParamPtr textItemParam; textItemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); //–ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ ParagraphParamPtr paragraphParam; paragraphParam = static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(100.0); paragraphParam-&gt;set_y(100.0); //–ù–∞—á–∏–Ω–∞–µ–º –ø–∞—Ä–∞–≥—Ä–∞—Ñ Document2D-&gt;ksParagraph(paragraphParam); //–ù–∞–ø–æ–ª–Ω—è–µ–º –ø–∞—Ä–∞–≥—Ä–∞—Ñ BSTR str = SysAllocString(L"–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞"); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); TextItemFontPtr textItemFont; textItemFont = static_cast&lt;TextItemFontPtr&gt;(textItemParam-&gt;GetItemFont()); textItemFont-&gt;SetBitVectorValue(NEW_LINE, true); str = SysAllocString(L"–í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞"); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); textItemFont.Unbind(); str = SysAllocString(L"–¢—Ä–µ—Ç—å—è —Å—Ç—Ä–æ–∫–∞"); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); //–ó–∞–≤–µ—Ä—à–∞–µ–º –ø–∞—Ä–∞–≥—Ä–∞—Ñ Document2D-&gt;ksEndObj(); paragraphParam.Unbind(); textItemParam.Unbind();</code> </pre><br></div></div><br>  This example creates a paragraph of three lines.  The first line is displayed as usual.  For the second, the <b>NEW_LINE</b> flag is <b>set</b> .  He talks about the beginning of a new line.  The third one is displayed as usual, but the <b>NEW_LINE</b> flag is still valid for it, since we are working with the same instance of the <b>ksTextItemParam</b> interface.  The figure below shows the paragraph formed by this program. <br><br> <a href=""><img src="https://habrastorage.org/webt/sw/3e/xl/sw3exlx1wgbxrnw6s7fmjshf4qm.png"></a> <br>  Now the lines are displayed correctly. <br><br><h1>  <font color="#00B2FF">Difficult moments of working with paragraphs</font> </h1><br><h2>  <font color="#00B2FF">Text alignment</font> </h2><br>  Text alignment is set by the <b>ksDocument2D</b> interface's <b>ksSetTextLineAlign method</b> .  It has only one integer parameter ‚Äî settable alignment.  Its valid values ‚Äã‚Äãare listed in the table below. <br><br><img src="https://habrastorage.org/webt/f2/yu/vd/f2yuvdi3o2kl2f7a5nsgglbsdli.png"><br><br>  If successful, the <b>ksSetTextLineAlign</b> method returns the previous alignment attribute, and in case of error, the number <i>-1</i> . <br><br>  Note that the <b>ksSetTextLineAlign</b> method can be used only inside a block (in our case it is used inside a paragraph).  This means that it cannot be used to set the alignment for the text displayed by the <b>ksText</b> method.  This limitation is due to the fact that in this case KOMPAS does not know as to which boundaries it is necessary to align the text. <br>  Another important point is related to the scope of the <b>ksSetTextLineAlign</b> method - on which output lines it acts.  Consider an example (here a strongly simplified syntax is used compared to their originals): <br><br><pre> <code class="plaintext hljs">ksSetTextLineAlign(1); ksTextLine(‚Äú–ü–æ —Ü–µ–Ω—Ç—Ä—É‚Äù); ksSetTextLineAlign(2); ksTextLine(‚Äú–ü–æ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é‚Äù);</code> </pre><br>  How will the lines be aligned?  Contrary to our expectations, both lines will be aligned to the right.  Why?  The point is that the <b>ksSetTextLineAlign</b> method first changes the alignment of the last line that was output.  Here is what happens in our example: the first line is centered.  Since there is no previous output line, this call changes the default alignment (left). <br><br>  Then we print the string ‚ÄúCenter‚Äù.  Initially, it uses the center alignment set earlier. <br><br>  In the third line, we again change the alignment.  First, the method changes the alignment of the previous line (‚ÄúCenter‚Äù).  Therefore, it is aligned to the right, not the center, as we had planned.  This alignment becomes alignable by default. <br>  We display the string "Right".  Since the <b>ksSetTextLineAlign</b> method <b>is</b> no longer called, it uses the previously set alignment (right). <br>  Thus, both lines are aligned to the right.  Now let's change the example a bit: <br><br><pre> <code class="plaintext hljs">ksSetTextLineAlign(1); ksTextLine(‚Äú–ü–æ —Ü–µ–Ω—Ç—Ä—É‚Äù); ksTextLine(‚Äú‚Äù); ksSetTextLineAlign(2); ksTextLine(‚Äú–ü–æ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é‚Äù);</code> </pre><br>  All that we changed was added empty line output without changing alignment.  Now the lines are displayed correctly.  This happens because the output of the empty string "absorbs" the settable right alignment.  The second call to the <b>ksSetTextLineAlign</b> method affects the empty line and does not affect the "Center" line in any way. <br>  The example below shows correct alignment without a blank line. <br><br><pre> <code class="plaintext hljs">ksTextLine(‚Äú–ü–æ —Ü–µ–Ω—Ç—Ä—É‚Äù); ksSetTextLineAlign(1); ksTextLine(‚Äú–ü–æ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é‚Äù); ksSetTextLineAlign(2);</code> </pre><br>  The <b>ksTextLine</b> and <b>ksSetTextLineAlign calls</b> are swapped.  Since the <b>ksSetTextLineAlign</b> method primarily affects the last output line, alignments are set correctly, and the lines are output the way we wanted. <br><br><h2>  <font color="#00B2FF">Example</font> </h2><br><div class="spoiler">  <b class="spoiler_title">The following is the source code of a program that demonstrates the alignment of text in a paragraph.</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">//–ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ksTextItemParam TextItemParamPtr textItemParam; textItemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); //–ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ ParagraphParamPtr paragraphParam; paragraphParam = static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(100.0); paragraphParam-&gt;set_y(100.0); paragraphParam-&gt;set_width(60.0); paragraphParam-&gt;set_hFormat(2); //–ù–∞—á–∏–Ω–∞–µ–º –ø–∞—Ä–∞–≥—Ä–∞—Ñ Document2D-&gt;ksParagraph(paragraphParam); //–ù–∞–ø–æ–ª–Ω—è–µ–º –ø–∞—Ä–∞–≥—Ä–∞—Ñ BSTR str = SysAllocString(L"–¢–µ–∫—Å—Ç –≤—ã—Ä–æ–≤–Ω–µ–Ω–Ω—ã–π –ø–æ –ª–µ–≤–æ–º—É –∫—Ä–∞—é"); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); TextItemFontPtr textItemFont; textItemFont = static_cast&lt;TextItemFontPtr&gt;(textItemParam-&gt;GetItemFont()); textItemFont-&gt;SetBitVectorValue(NEW_LINE, true); str = SysAllocString(L""); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); textItemFont.Unbind(); str = SysAllocString(L"–ü–æ —Ü–µ–Ω—Ç—Ä—É"); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); Document2D-&gt;ksSetTextLineAlign(1); str = SysAllocString(L""); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); str = SysAllocString(L"–î–ª–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–µ–º—ã–π –ø–æ —à–∏—Ä–∏–Ω–µ"); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); Document2D-&gt;ksSetTextLineAlign(3); //–ó–∞–≤–µ—Ä—à–∞–µ–º –ø–∞—Ä–∞–≥—Ä–∞—Ñ Document2D-&gt;ksEndObj(); paragraphParam.Unbind(); textItemParam.Unbind();</code> </pre><br></div></div><br>  In this example, in addition to text alignment, the use of the <b>width</b> and <b>hFormat</b> properties of the <b>ksParagraphParam</b> interface is also demonstrated.  They are used to limit its width.  If we didn‚Äôt change them, COMPASS would increase the width of the paragraph, and we wouldn‚Äôt see left-justification and width alignment. <br><br>  Blank lines are displayed to improve paragraph readability.  They do not affect the alignment. <br><br>  The figure below shows the paragraph formed by this program. <br><br> <a href=""><img src="https://habrastorage.org/webt/jh/kh/bx/jhkhbxlyjawnod_y31k2re1vuz8.png"></a> <br><br><h2>  <font color="#00B2FF">Turn on and off tracing</font> </h2><br>  In the <a href="https://habr.com/company/ascon/blog/417723/">11th cycle lesson,</a> we looked at the flags that control the outline ( <i>ITALIC_ON</i> , <i>ITALIC_OFF</i> , <i>BOLD_ON</i> , <i>UNDERLINE_ON</i> and <i>UNDERLINE_OFF</i> ).  Then we considered them in relation to the <b>ksText</b> method.  An important difference in their use in a paragraph is that the action is not limited to calling the <b>ksTextLine</b> method, but extends to the entire paragraph.  Consider a few examples. <br><br><pre> <code class="plaintext hljs">TextItemFont-&gt;SetBitVectorValue(BOLD_ON, true); TextItemParam-&gt;s = SysAllocString(L‚Äù–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞‚Äù); Document2D-&gt;ksTextLine(TextItemParam); TextItemFont-&gt;Init(); TextItemParam-&gt;s = SysAllocString(L‚Äù–í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞‚Äù); Document2D-&gt;ksTextLine(TextItemParam);</code> </pre><br>  The first line will be displayed in bold.  There are no questions with this.  But how will the second line be displayed?  For her, the <i>BOLD_ON</i> flag <i>is</i> cleared.  Therefore, we can assume that it will be displayed in normal font.  But it is not.  Upon encountering the <i>BOLD_ON</i> flag, KOMPAS understands the command as follows: all subsequent lines in this paragraph are displayed in bold.  Therefore, all subsequent lines are displayed in bold until the paragraph is completed or COMPASS meets the <i>BOLD_OFF</i> flag <i>paired to it</i> .  Consider an example: <br><br><pre> <code class="plaintext hljs">TextItemFont.SetBitVectorValue(BOLD_ON, true); TextItemParam.s = SysAllocString(L‚Äù–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞‚Äù); Document2D.ksTextLine(TextItemParam); TextItemFont.Init(); TextItemFont.SetBitVectorValue(BOLD_OFF, true); TextItemParam.s = SysAllocString(L‚Äú–í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞‚Äù); Document2D.ksTextLine(TextItemParam); TextItemFont.Init(); TextItemParam.s = SysAllocString(L‚Äù–¢—Ä–µ—Ç—å—è —Å—Ç—Ä–æ–∫–∞‚Äù); Document2D.ksTextLine(TextItemParam);</code> </pre><br>  The first line is displayed in bold.  For the second line, we reset the <i>BOLD_ON</i> flag and coax the flag <i>BOLD_OFF</i> , which cancels it in bold.  Due to this, the second and third lines are displayed without bold. <br><br>  This behavior applies to the <i>ITALIC_ON</i> , <i>ITALIC_OFF</i> , <i>UNDERLINE_ON</i> and <i>UNDERLINE_OFF flags</i> , but does not apply to the <i>NEW_LINE</i> flag, since there is no paired cancel flag for it. <br><br><h2>  <font color="#00B2FF">Example</font> </h2><br><div class="spoiler">  <b class="spoiler_title">Below is the source text of the program, demonstrating the output of text with different styles with the help of paragraphs.</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">//–ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ksTextItemParam TextItemParamPtr textItemParam; textItemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); //–ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ ParagraphParamPtr paragraphParam; paragraphParam = static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(100.0); paragraphParam-&gt;set_y(100.0); //–ù–∞—á–∏–Ω–∞–µ–º –ø–∞—Ä–∞–≥—Ä–∞—Ñ Document2D-&gt;ksParagraph(paragraphParam); //–ù–∞–ø–æ–ª–Ω—è–µ–º –ø–∞—Ä–∞–≥—Ä–∞—Ñ BSTR str = SysAllocString(L"–û–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç"); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); TextItemFontPtr textItemFont; textItemFont = static_cast&lt;TextItemFontPtr&gt;(textItemParam-&gt;GetItemFont()); textItemFont-&gt;set_bitVector(NEW_LINE | ITALIC_OFF); // str = SysAllocString(L"–¢–µ–∫—Å—Ç –±–µ–∑ –Ω–∞–∫–ª–æ–Ω–∞"); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); textItemFont-&gt;set_bitVector(NEW_LINE | ITALIC_ON | BOLD_ON); // str = SysAllocString(L"–ü–æ–ª—É–∂–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç"); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); textItemFont-&gt;set_bitVector(NEW_LINE | BOLD_OFF | UNDERLINE_ON); // str = SysAllocString(L"–ü–æ–¥—á–µ—Ä–∫–Ω—É—Ç—ã–π —Ç–µ–∫—Å—Ç"); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); //–ó–∞–≤–µ—Ä—à–∞–µ–º –ø–∞—Ä–∞–≥—Ä–∞—Ñ Document2D-&gt;ksEndObj(); paragraphParam.Unbind(); textItemFont.Unbind(); textItemParam.Unbind();</code> </pre><br></div></div><br>  The most important part of this program is the correct setting of the flags for the output lines.  Let us analyze it in more detail (the corresponding program lines are marked with a pair of ‚Äú <i>//</i> ‚Äù characters). <br><br>  The first line is displayed without any changes.  Therefore, no flags are set for it. <br><br>  The second line should be displayed without slope and with a new line.  Therefore, the following flags are set for it: <i>NEW_LINE</i> (start from a new line) and <i>ITALIC_OFF</i> (disable italic). <br><br>  The third line should be in italics and bold.  To do this, we set the flags: <i>NEW_LINE</i> , <i>ITALIC_ON</i> (turn on italics) and <i>BOLD_ON</i> (turn on bold).  All other flags reset. <br><br>  The fourth line should be in italics, underlined and not in bold.  To do this, we set the flags: <i>NEW_LINE</i> , <i>BOLD_OFF</i> (disable bold, remaining enabled from the previous line) and <i>UNDERLINE_ON</i> (enable underlined). <br><br>  If there were more lines in a paragraph, they would be displayed in italic, underlined font.  To turn off the underlined outline you need to reset the UNDERLINE_ON flag and set the <i>UNDERLINE_OFF</i> flag. <br><br>  The figure below shows the result of this program. <br><br> <a href=""><img src="https://habrastorage.org/webt/p-/gc/sy/p-gcsy8wpi5wz8gxaa69q55uut4.png"></a> <br><br><h2>  <font color="#00B2FF">Separation of information from submission</font> </h2><br>  If you follow the structure of your programs, you probably noticed a serious drawback of the previous example: the code responsible for generating the output information is mixed with the code responsible for implementing its output.  With a good programming style, it is customary to separate information from its presentation. <br><br>  If the output information consists of several <b>ksTextItemParam</b> lines, then they can be combined into one <b>ksTextLineParam</b> interface.  The <b>ksTextLine</b> method can handle both of these interfaces.  But this approach has an unpleasant limitation: if the <b>ksTextLine</b> method accepts the <b>ksTextLineParam</b> interface, the <i>NEW_LINE</i> flags (and <i>SPECIAL_SYMBOL_END</i> ) are ignored.  That is, all information will be displayed in one line, even if for some instances of <b>ksTextItemParam the NEW_LINE</b> flag is <i>coded</i> .  To bypass this restriction, you will have to manually call <b>ksTextLine</b> for each line. <br><br><div class="spoiler">  <b class="spoiler_title">Below is the source code of an example demonstrating this technique.</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">//–ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–∞—Å—Å–∏–≤–∞ —Å—Ç—Ä–æ–∫ DynamicArrayPtr dynamicArray; dynamicArray = static_cast&lt;DynamicArrayPtr&gt;(kompas-&gt;GetDynamicArray(TEXT_ITEM_ARR)); dynamicArray-&gt;ksClearArray(); //–ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ksTextItemParam TextItemParamPtr textItemParam; textItemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); //–ù–∞–ø–æ–ª–Ω—è–µ–º –º–∞—Å—Å–∏–≤ —Å—Ç—Ä–æ–∫ BSTR str = SysAllocString(L"–û–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç"); textItemParam-&gt;set_s(str); dynamicArray-&gt;ksAddArrayItem(-1, textItemParam); SysFreeString(str); TextItemFontPtr textItemFont; textItemFont = static_cast&lt;TextItemFontPtr&gt;(textItemParam-&gt;GetItemFont()); textItemFont-&gt;set_bitVector(NEW_LINE | ITALIC_OFF); str = SysAllocString(L"–¢–µ–∫—Å—Ç –±–µ–∑ –Ω–∞–∫–ª–æ–Ω–∞"); textItemParam-&gt;set_s(str); dynamicArray-&gt;ksAddArrayItem(-1, textItemParam); SysFreeString(str); textItemFont-&gt;set_bitVector(NEW_LINE | ITALIC_ON | BOLD_ON); str = SysAllocString(L"–ü–æ–ª—É–∂–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç"); textItemParam-&gt;set_s(str); dynamicArray-&gt;ksAddArrayItem(-1, textItemParam); SysFreeString(str); textItemFont-&gt;set_bitVector(NEW_LINE | BOLD_OFF | UNDERLINE_ON); str = SysAllocString(L"–ü–æ–¥—á–µ—Ä–∫–Ω—É—Ç—ã–π —Ç–µ–∫—Å—Ç"); textItemParam-&gt;set_s(str); dynamicArray-&gt;ksAddArrayItem(-1, textItemParam); SysFreeString(str); //–ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ ParagraphParamPtr paragraphParam; paragraphParam = static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(100.0); paragraphParam-&gt;set_y(100.0); //–ù–∞—á–∏–Ω–∞–µ–º –ø–∞—Ä–∞–≥—Ä–∞—Ñ Document2D-&gt;ksParagraph(paragraphParam); //–í—ã–≤–æ–¥–∏–º –≤ –ø–∞—Ä–∞–≥—Ä–∞—Ñ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–∞—Å—Å–∏–≤–∞ for(unsigned int i = 0; i &lt; dynamicArray-&gt;ksGetArrayCount(); ++i) { dynamicArray-&gt;ksGetArrayItem(i, textItemParam); Document2D-&gt;ksTextLine(textItemParam); } //–ó–∞–≤–µ—Ä—à–∞–µ–º –ø–∞—Ä–∞–≥—Ä–∞—Ñ Document2D-&gt;ksEndObj(); //–û—Å–≤–æ–±–æ–∂–¥–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã textItemFont.Unbind(); textItemParam.Unbind(); paragraphParam.Unbind(); dynamicArray-&gt;ksDeleteArray(); dynamicArray.Unbind();</code> </pre><br></div></div><br>  In this example, the output lines are first entered into the dynamic array <b>DynamicArray</b> , and only then displayed in the paragraph.  This allows you to separate information from its presentation.  If in our example the <i>NEW_LINE</i> flag was not used, then we could do with a single call to the <b>ksTextLine</b> method. <br><br>  The result of this program is similar to the result of the previous example. <br><br>  <b>Conclusion</b> <br><br>  In this lesson, we looked at how to build a paragraph and how to use it to display multi-line text.  We also learned to separate information from its presentation.  Unfortunately, the correct output of multi-line text requires manual traversal of the array of strings.  This is not very convenient.  In the next lesson, I will show you how to solve this problem. <br><br>  <b>To be continued, stay tuned to the blog.</b> <br><br> <a href=""><img align="left" src="https://habrastorage.org/web/595/eee/f27/595eeef271b24830b3578751fcb52716.png"></a>  Sergey Norseev, Ph.D., author of the book ‚ÄúDevelopment of applications for COMPAS in Delphi‚Äù. </div><p>Source: <a href="https://habr.com/ru/post/434336/">https://habr.com/ru/post/434336/</a></p>
<section class="all-articles-navigation-panel js-all-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><p>Waiting for the list form <a href="../../index.html">here</a>...</p></nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>