<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>BLE under the microscope 4</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="BLE under the microscope. Part 4 
 A few words about whitelist. 

 It so happened that I moved away from the BLE topic for a long time. But I came bac...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <div class="page-header-logo-container"></div>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>BLE under the microscope 4</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/408/ea7/79a/408ea779ab2a443c93e61c1166a27615.png" alt="image"><br><br><h2>  BLE under the microscope.  Part 4 </h2><br>  A few words about whitelist. <br><br>  It so happened that I moved away from the BLE topic for a long time.  But I came back :-) Today I want to touch on the topic of whitelist.  What is it for?  If we want only certain phones to work with our gadget, while others could not, then whitelist is what we need. <br><a name="habracut"></a><br>  In order to begin to discuss this topic will have to go back a little.  In order for the devices to begin the exchange of data, it is necessary to undergo the procedure of connection.  I wrote about it in previous articles.  And here it is very important not to confuse the concept of joining and mating.  In the case of joining, after breaking the connection, we forget about who we communicated with.  In the case of mating - we remember the partner.  So, for example, we connect your phone with bluetooth headphones.  Such devices are now called bound.  Now when scanning the air, the connection to the associated device will occur without human intervention. <br><br>  Why am I talking about all this?  The fact is that whitelist is formed from a list of related devices.  This is the first thing to remember.  Secondly, it is necessary to understand how device binding is formed.  There are two ways.  The first is by the MAC address, the second using keys.  Why is everything so difficult?  The fact is that at first it was only supposed to bind by MAC address.  But, when transmitting packets over the air, it is visible to everyone.  Because of this, by scanning the air and using special programs, an attacker can easily replace the MAC address on his phone.  As a result, even when using whitelist-a, he can access your device.  To prevent this, another device binding method is used - using the irk-keys (Identity Resolving Key).  Unlike the MAC address, the key length is 16 bytes, and with standard data exchange, they are not visible on the air.  They are exchanged in a safe place, excluding audition.  In addition, the BLE4.2 specification describes another feature.  Here it is, literally: <br><br>  6.1 PRIVATE ADDRESS GENERATION INTERVAL <br><br>  A private address shall be generated using the Resolvable Private Address Generation (see Section 1.3.2.2).  A new private addressshall be generated when the timer expires.  If the link has been reset, it has been reset. <br><br>  Note: If the private address is generated frequently, connection may be affected.  It is recommended to set the timer to 15 minutes. <br><br>  In short, the BLE device can broadcast not its own public address, but a private private address, which is recommended to be changed every 15 minutes.  Therefore, it does not make sense to memorize them.  You only need to remember the public and random static address.  In the debugger, it looks like this: <br><br><img src="https://habrastorage.org/webt/v-/_l/ja/v-_lja1szt81lazwkr94ywhmclm.png"><br><br>  It is worth noting here that the addr_count counter in the picture on the left is 0x01, and the irk_count counter in the picture on the right is 0x02.  The fact is that I tied two phones to the device with Android 4.4 (bluetooth 4.0) and Android 8.1 (bluetooth 4.1).  Those.  the first one is connected by MAC address, and the second one already uses irk keys.  Moreover, I tied the phone with android 8.1 twice.  My device did not recognize it and saw them as two different phones. <br><br>  There is a good <a href="https://habr.com/post/394757/">article</a> on the site that decodes abbreviations and gives a general overview of the BLE technology.  In addition, I want to note that there may be inaccuracies in the text, because  I do not deal with this topic as much as I would like.  Therefore, constructive comments are accepted and welcome. <br><br>  Pecherskikh Vladimir </div><p>Source: <a href="https://habr.com/ru/post/434746/">https://habr.com/ru/post/434746/</a></p>
<section class="navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><p>Waiting for the list form <a href="../../index.html">here</a>...</p></nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>
</body>

</html>