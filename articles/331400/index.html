<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We add reactivity to string template engines.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="One of the advantages of string template engines such as JUST.js, jqueryTmpl or handlebarsjs over template engines based on a virtual DOM tree (VUE.js...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-6974184241884155",
      enable_page_level_ads: true
    });
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We add reactivity to string template engines.</h1><div class="post__text post__text-html js-mediator-article">  One of the advantages of string template engines such as JUST.js, jqueryTmpl or handlebarsjs over template engines based on a virtual DOM tree (VUE.js, angular) is a low threshold of entry and ease of use.  It also seems to me that it is easier to integrate plugins for jquery with string template engines. <br><br>  However, the ability to reactively bind the model data to a template is really a handy tool, and after I tried VUE.js and angular, I really missed that in my favorite <a href="https://habrahabr.ru/post/138939/">JUST.JS</a> template <a href="https://habrahabr.ru/post/138939/">engine</a> . <br><br>  In the end, I decided to add one-way reactive data binding in JUST.JS, but in the end I got a <a href="https://github.com/Levhav/justReactive">solution</a> that can be used with almost any string template engine. <br><a name="habracut"></a><br><h1>  Let's start with a simple example. </h1><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://codepen.io/Levhav/embed/preview/zzzdLw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  In it, we did without a template engine at all for simplicity and clarity of the code.  In this example, a new value is assigned once per second to a variable.  And then justReactive for you makes changes to the dom tree of the page. <br><br>  The justReactive library adds the following methods for Object, each of which is intended to insert the monitored value into different places of the html code. <br><br><ul><li>  justHtml - display text or html code from a variable without any filtering </li><li>  justText - display text from a variable as text, with html entities converting to text </li><li>  justClass - substitutes the class if the value of the monitored variable is not false </li><li>  justNotClass - substitutes the class if the value of the variable being tracked is false </li><li>  justClassName ‚Äî substitutes the value of the variable being tracked as a class </li><li>  justAttr - substitutes and updates the attribute of the element </li></ul><br><h1>  Operating principle </h1><br>  The following call: <br><br><pre><code class="javascript hljs">model.justText(<span class="hljs-string"><span class="hljs-string">'time'</span></span>)</code> </pre> <br>  will return the html code that you need to insert into the template at the place where your variable should be.  It is redundant, that is, in addition to the value of the variable itself, we have to wrap it with additional elements. <br><br>  So for example, justText will return the following html code: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_justReactive2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"display: inline;"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"just-watch just-watch-text"</span></span></span><span class="hljs-tag">&gt;</span></span>1498115282970<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Such redundancy sometimes interferes with the layout, but this is the price that is necessary for the possibility of further changing the value directly on the page.  By performing a simple assignment. <br><br>  It is also necessary to take into account the fact that after adding tracking of a variable, its value is replaced with an object with a hetero and a seter ( <a href="https://learn.javascript.ru/descriptors-getters-setters">for those who do not know about this possibility</a> ) and later on assignments they are called, so if you already use the functions of heteros and seters in your code then we need to think about the absence of conflicts. <br><br><h1>  Another usage example </h1><br>  This example is based on the previous one.  Here we have added tracking of another model.class variable to change the class of an element and the model.hide variable to hide another element. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://codepen.io/Levhav/embed/preview/xrrXEz" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h1>  Disadvantages approach </h1><br>  This approach has a number of problems that need to be considered when working with code.  In the following situation, we can get not what we wanted: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> model = {}; model.key1 = <span class="hljs-number"><span class="hljs-number">1</span></span>; $(<span class="hljs-string"><span class="hljs-string">"#time1"</span></span>).html(model.justText(<span class="hljs-string"><span class="hljs-string">'key1'</span></span>)) model = {<span class="hljs-attr"><span class="hljs-attr">key1</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>};</code> </pre><br>  In this example, the value in the dom tree will not be updated because the assignment in model = {key1: 2};  in fact, first deleted the model.key1 that we are tracking, and then created a new model object with the same, but not the same key, key1. <br><br><h1>  Cycles and blocks of patterns </h1><br>  To change the individual elements of what we have considered enough.  But sometimes you want to work when changing one variable to rebuild a whole block of the template.  For example, if we monitor an array and add another element to it, we want to rebuild the entire list of elements. <br><br>  To solve this problem, we could immediately insert a large block of html code into one of the elements. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://codepen.io/Levhav/embed/preview/eRRGPK" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  But even though this works, it is not very convenient.  I personally made a fork of the <a href="https://github.com/baryshev/just">just.js</a> template <a href="https://github.com/baryshev/just">engine</a> and added a number of additional features to it along the way cutting out what seemed to me superfluous in it. <br><br>  I called the resulting modified template engine <a href="https://github.com/Levhav/just-template">just-template</a> <br><br>  In it, I added a structure to track the variables of the model that immediately rebuilds the template block that is attached to it.  In this case, through the closure, all variables are transferred when the template is built for the first time. <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">~</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">this.data.itemslist</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">(</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">var</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">in</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">this.data.itemslist</span></span></span><span class="hljs-tag">){ %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%=</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">this.data.itemslist</span></span></span><span class="hljs-tag">[</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span><span class="hljs-tag">]</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">.justText</span></span></span><span class="hljs-tag">('</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">') %&gt;</span></span> - <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%-</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">this.data.itemslist</span></span></span><span class="hljs-tag">[</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span><span class="hljs-tag">]</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">.text</span></span></span><span class="hljs-tag"> %&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%</span></span></span><span class="hljs-tag"> } %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">~</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Added data filtering: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%-</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">text</span></span></span><span class="hljs-tag"> %&gt;</span></span> -   <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%=</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">text</span></span></span><span class="hljs-tag"> %&gt;</span></span> -  </code> </pre><br>  And I completely cut out all the asynchrony since I only use it at the frontend and the lack of asynchrony greatly simplifies the code.  And allows you to easily collect the final page in pieces by calling several different templates. <br><br>  The final example with an array and cycles and pattern. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://codepen.io/Levhav/embed/preview/Nggamg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h1>  Links </h1><br><ul><li>  <a href="https://github.com/Levhav/justReactive">justReactive</a> </li><li>  <a href="https://github.com/Levhav/just-template">just-template</a> </li><li>  <a href="https://habrahabr.ru/post/138939/">Description of the original JUST.JS</a> </li><li>  <a href="https://learn.javascript.ru/descriptors-getters-setters">About getters and setors</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/331400/">https://habr.com/ru/post/331400/</a></p>
<section class="all-articles-navigation-panel js-all-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><p>Waiting for the list form <a href="../../index.html">here</a>...</p></nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>