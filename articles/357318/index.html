<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>DoS attack on the MikroTik line of equipment and virtual RouterOS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In MikroTik, they did not have time to patch the vulnerability voiced in the article from the CIA hack tools, as the possibility of performing Denial ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>DoS attack on the MikroTik line of equipment and virtual RouterOS</h1><div class="post__text post__text-html js-mediator-article">  In MikroTik, they did not have time to patch the vulnerability voiced in the <a href="https://geektimes.ru/post/286702/">article</a> from the CIA hack tools, as the possibility of performing Denial Of Service on remote equipment running on RouterOS was discovered (all versions of OS are pre-attack). <br><a name="habracut"></a><br>  The vulnerability allows you to load the RouterOS CPU 100% by sending a heap of TCP RST packets to port 8291 which is used by default by Winbox.  By default, access to this port is closed by the firewall, but if you opened it to control your tics via the Internet, you should at least change the default port, and at best, register permission to access the winbox only for certain ip (although not the fact that it will save): <br><br><pre><code class="hljs pgsql">ip firewall <span class="hljs-keyword"><span class="hljs-keyword">filter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> chain=<span class="hljs-keyword"><span class="hljs-keyword">input</span></span> action=accept protocol=tcp src-address=ADMIN_IP dst-port=<span class="hljs-number"><span class="hljs-number">8291</span></span> <span class="hljs-keyword"><span class="hljs-keyword">comment</span></span>=Allow_Winbox</code> </pre> <br>  According to the discussion on the <a href="https://forum.mikrotik.com/viewtopic.php%3Ff%3D1%26t%3D120270">off.</a>  <a href="https://forum.mikrotik.com/viewtopic.php%3Ff%3D1%26t%3D120270">Site</a> vulnerabilities are subject to both hardware devices (tested on: RB751, hEX lite, RB951, RB2011, CCR1036 and even RB3011) and virtual CHR (tested for 8x Xeon). <br><br>  An example of a working exploit is in the <a href="https://cxsecurity.com/issue/WLB-2017030242">public domain</a> . <br><br><img src="https://habrastorage.org/files/5ab/68b/9f2/5ab68b9f2d1440b891e4c8ec961a4b0d.png"><br><br>  The official representative of MikroTik <a href="https://forum.mikrotik.com/viewtopic.php%3Ff%3D1%26t%3D120270">advises to</a> disable all services in the Ip service menu (be careful), change the standard ports, use a router, restrict access to these services only from the internal network via vpn on a third-party device, or buy a more productive router.  And in general it is from his words ‚Äúnormal situation‚Äù that the CPU performance is not enough to handle such a number of packets ... </div><p>Source: <a href="https://habr.com/ru/post/357318/">https://habr.com/ru/post/357318/</a></p>
<section class="all-articles-navigation-panel js-all-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><p>Waiting for the list form <a href="../../index.html">here</a>...</p></nav>
</section>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>